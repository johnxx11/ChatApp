{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useEffect,useState}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{Avatar,ListItem}from'react-native-elements';import{db}from\"../../firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var timeNow=new Date();Date.prototype.getFullMinutes=function(){if(this.getDate()<timeNow.getDate()||this.getDate()>=timeNow.getDate()&&this.getMonth()<timeNow.getMonth()||this.getDate()>=timeNow.getDate()&&this.getMonth()>=timeNow.getMonth()&&this.getFullYear()<timeNow.getFullYear()){return this.getMonth()+1+\"/\"+this.getDate();}if(this.getMinutes()<10){return this.getHours()+\":0\"+this.getMinutes();}return this.getHours()+\":\"+this.getMinutes();};var CustomListItem=function CustomListItem(_ref){var _chatMessages$,_chatMessages$2,_chatMessages$2$times,_chatMessages$2$times2;var id=_ref.id,chatName=_ref.chatName,enterChat=_ref.enterChat;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chatMessages=_useState2[0],setChatMessages=_useState2[1];useEffect(function(){var unsubscribe=db.collection('chats').doc(id).collection('messages').orderBy('timestamp','desc').onSnapshot(function(snapshot){return setChatMessages(snapshot.docs.map(function(doc){return doc.data();}));});return unsubscribe;});return _jsxs(ListItem,{onPress:function onPress(){return enterChat(id,chatName);},bottomDivider:true,style:styles.container,children:[_jsx(Avatar,{size:40,source:{uri:(chatMessages==null?void 0:(_chatMessages$=chatMessages[0])==null?void 0:_chatMessages$.photoURL)||\"https://res.cloudinary.com/crunchbase-production/image/upload/c_lpad,f_auto,q_auto:eco,dpr_1/nesuuhyyzmjip7zg0kg4\"},avatarStyle:{borderRadius:5}}),_jsxs(ListItem.Content,{children:[_jsx(ListItem.Title,{style:styles.chatName,numberOfLines:1,ellipsizeMode:\"tail\",children:chatName}),_jsx(ListItem.Subtitle,{style:styles.lastMessage,numberOfLines:1,ellipsizeMode:\"tail\",children:chatMessages[0]?chatMessages[0].displayName+\": \"+chatMessages[0].message:''})]}),_jsx(Text,{style:styles.time,children:chatMessages==null?void 0:(_chatMessages$2=chatMessages[0])==null?void 0:(_chatMessages$2$times=_chatMessages$2.timestamp)==null?void 0:(_chatMessages$2$times2=_chatMessages$2$times.toDate())==null?void 0:_chatMessages$2$times2.getFullMinutes()})]},id);};var styles=StyleSheet.create({chatName:{fontWeight:\"800\",flexDirection:\"row\",color:\"#191970\",fontSize:16,alignSelf:\"flex-start\",right:8,bottom:3},lastMessage:{color:\"grey\",fontWeight:\"600\",flexDirection:\"row\",alignSelf:\"flex-start\",right:8,fontSize:\"15\"},time:{alignSelf:\"flex-end\",color:\"grey\",fontWeight:\"600\",fontSize:\"15\",alignSelf:\"flex-end\"}});export default CustomListItem;","map":{"version":3,"names":["React","useEffect","useState","Avatar","ListItem","db","timeNow","Date","prototype","getFullMinutes","getDate","getMonth","getFullYear","getMinutes","getHours","CustomListItem","id","chatName","enterChat","chatMessages","setChatMessages","unsubscribe","collection","doc","orderBy","onSnapshot","snapshot","docs","map","data","styles","container","uri","photoURL","borderRadius","lastMessage","displayName","message","time","timestamp","toDate","StyleSheet","create","fontWeight","flexDirection","color","fontSize","alignSelf","right","bottom"],"sources":["/Users/johnwu/ChatApp/ChatApp/ChatApp/screens/components/CustomListItem.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\nimport { Avatar, ListItem } from 'react-native-elements';\nimport { db } from '../../firebase';\n\nlet timeNow = new Date();\n\nDate.prototype.getFullMinutes = function () {\n    if (this.getDate() < timeNow.getDate() || \n        (this.getDate() >= timeNow.getDate() && this.getMonth() < timeNow.getMonth()) ||\n        (this.getDate() >= timeNow.getDate() && this.getMonth() >= timeNow.getMonth() && this.getFullYear() < timeNow.getFullYear())) {\n        return (this.getMonth() + 1) + \"/\" + this.getDate();\n    }\n    if (this.getMinutes() < 10) {\n        return this.getHours()+ \":0\" + this.getMinutes();\n    }\n    return this.getHours() + \":\" + this.getMinutes();\n };\n\nconst CustomListItem = ({ id, chatName, enterChat }) => {\n    const [chatMessages, setChatMessages] = useState([]);\n    \n    useEffect(() => {\n        const unsubscribe = db\n            .collection('chats')\n            .doc(id)\n            .collection('messages')\n            .orderBy('timestamp', 'desc')\n            .onSnapshot((snapshot) =>\n                setChatMessages(snapshot.docs.map((doc) => doc.data()))\n            );\n        return unsubscribe;\n    });\n\n    return (\n        <ListItem onPress={() => enterChat(id, chatName)} key={id} bottomDivider style={styles.container}>\n            <Avatar\n                size={40}\n                source={{uri: chatMessages?.[0]?.photoURL || \n                \"https://res.cloudinary.com/crunchbase-production/image/upload/c_lpad,f_auto,q_auto:eco,dpr_1/nesuuhyyzmjip7zg0kg4\"}}\n                avatarStyle={{borderRadius: 5 }}\n            />\n            <ListItem.Content>\n                <ListItem.Title style={styles.chatName} numberOfLines={1} ellipsizeMode=\"tail\">\n                    {chatName}\n                </ListItem.Title>\n                <ListItem.Subtitle style={styles.lastMessage} numberOfLines={1} ellipsizeMode=\"tail\">   \n                    {(chatMessages[0]) ? (chatMessages[0].displayName + \": \" + chatMessages[0].message) : ('')}  \n                </ListItem.Subtitle>\n            </ListItem.Content>\n            <Text style={styles.time}>{chatMessages?.[0]?.timestamp?.toDate()?.getFullMinutes()}</Text>\n        </ListItem>\n    );\n};\n\nconst styles = StyleSheet.create({\n    chatName: {\n        fontWeight: \"800\",\n        flexDirection: \"row\",\n        color: \"#191970\",\n        fontSize: 16,\n        alignSelf: \"flex-start\",\n        right: 8,\n        bottom: 3,\n    },\n    lastMessage: {\n        color: \"grey\",\n        fontWeight: \"600\",\n        flexDirection: \"row\",\n        alignSelf: \"flex-start\",\n        right: 8,\n        fontSize: \"15\",\n    },\n    time: {\n        alignSelf: \"flex-end\",\n        color: \"grey\",\n        fontWeight: \"600\",\n        fontSize: \"15\",\n        alignSelf: \"flex-end\",\n    }\n});\n\nexport default CustomListItem;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}